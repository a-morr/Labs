import matplotlib
matplotlib.rcParams = matplotlib.rc_params_from_file('../../matplotlibrc')
from matplotlib import pyplot as plt

def logProbs():
    # this list was pre-computed as a good example illustrating convergence issues
    log_probs = [-25833.049559516912,
     -22193.805066044672,
     -22193.798295110711,
     -22193.791338214811,
     -22193.784071140748,
     -22193.776393897824,
     -22193.768235161362,
     -22193.759556507943,
     -22193.750355553006,
     -22193.740666895243,
     -22193.730559867319,
     -22193.720132563536,
     -22193.709502396276,
     -22193.698794319618,
     -22193.688128535407,
     -22193.677609695136,
     -22193.667319241104,
     -22193.657311730938,
     -22193.647615063255,
     -22193.638233773694,
     -22193.629154180839,
     -22193.620350151301,
     -22193.61178850547,
     -22193.603433457647,
     -22193.59524984187,
     -22193.587205145614,
     -22193.579270538092,
     -22193.571421147113,
     -22193.563635838411,
     -22193.555896714024,
     -22193.548188491863,
     -22193.540497875601,
     -22193.532812978086,
     -22193.525122828323,
     -22193.517416968636,
     -22193.509685134923,
     -22193.501917006884,
     -22193.494102012621,
     -22193.486229172395,
     -22193.478286969072,
     -22193.470263234387,
     -22193.462145043053,
     -22193.453918608138,
     -22193.44556917316,
     -22193.437080896765,
     -22193.428436727052,
     -22193.41961826272,
     -22193.410605598056,
     -22193.401377149195,
     -22193.391909458671,
     -22193.382176974315,
     -22193.372151799162,
     -22193.361803407468,
     -22193.35109832136,
     -22193.339999742275,
     -22193.328467129053,
     -22193.316455714667,
     -22193.303915950521,
     -22193.290792866123,
     -22193.277025329167,
     -22193.262545188241,
     -22193.247276276255,
     -22193.231133249476,
     -22193.214020229279,
     -22193.195829209722,
     -22193.176438182822,
     -22193.155708925133,
     -22193.133484373724,
     -22193.109585504753,
     -22193.083807605122,
     -22193.055915801342,
     -22193.025639674546,
     -22192.99266674586,
     -22192.956634558854,
     -22192.917121008948,
     -22192.873632472521,
     -22192.825589155174,
     -22192.772306907416,
     -22192.712974520437,
     -22192.646625203124,
     -22192.572100512851,
     -22192.48800442728,
     -22192.392644435706,
     -22192.283955396506,
     -22192.159400316337,
     -22192.015839937692,
     -22191.849359761462,
     -22191.655038385383,
     -22191.42663406031,
     -22191.156155969475,
     -22190.833271061165,
     -22190.444473319181,
     -22189.971905294398,
     -22189.391663584898,
     -22188.67132755959,
     -22187.766301937299,
     -22186.614321927973,
     -22185.127072848227,
     -22183.177223392508,
     -22180.578105288885,
     -22177.051573777284,
     -22172.177052384643,
     -22165.311606567328,
     -22155.469099249294,
     -22141.153951995297,
     -22120.185274245341,
     -22089.672050384397,
     -22046.561967983995,
     -21989.406976464699,
     -21921.254933920594,
     -21850.94165114611,
     -21788.927154476558,
     -21740.497864576806,
     -21704.52842575618,
     -21677.488137052344,
     -21656.491983754342,
     -21639.794049292213,
     -21626.335801778816,
     -21615.392932650982,
     -21606.425562310218,
     -21599.01760241016,
     -21592.844285856419,
     -21587.650467499763,
     -21583.2346398355,
     -21579.43660555008,
     -21576.12795541012,
     -21573.204898796001,
     -21570.583008288675,
     -21568.193406955077,
     -21565.979966604937,
     -21563.897183851455,
     -21561.908511705478,
     -21559.985014053775,
     -21558.104266895436,
     -21556.249453502875,
     -21554.408449916853,
     -21552.566554989404,
     -21550.48688104402,
     -21546.548666123304,
     -21543.009952228931,
     -21540.918474541078,
     -21539.042440861544,
     -21537.251319318559,
     -21535.51899712329,
     -21533.837179621143,
     -21532.205391595708,
     -21530.626576703602,
     -21529.104970109522,
     -21527.645063067008,
     -21526.251089269957,
     -21524.926755216657,
     -21523.675081551803,
     -21522.498296446516,
     -21521.39776056417,
     -21520.373921947208,
     -21519.426306007874,
     -21518.553545355473,
     -21517.753449895063,
     -21517.02311225059,
     -21516.359039089832,
     -21515.757296464926,
     -21515.213657067903,
     -21514.723738952569,
     -21514.28312804806,
     -21513.887479938414,
     -21513.532599280341,
     -21513.214497520887,
     -21512.929431120134,
     -21512.67392332189,
     -21512.444772782084,
     -21512.239052238045,
     -21512.054100036257,
     -21511.887506865562,
     -21511.737099554419,
     -21511.600923342143,
     -21511.477223648006,
     -21511.364428052431,
     -21511.261128962702,
     -21511.166067256163,
     -21511.078117064688,
     -21510.996271773449,
     -21510.919631244491,
     -21510.847390238232,
     -21510.778827979404,
     -21510.713298800751,
     -21510.650223790821,
     -21510.58908336977,
     -21510.529410717907,
     -21510.470785985322,
     -21510.412831212212,
     -21510.355205896354,
     -21510.297603147221,
     -21510.239746370236,
     -21510.181386429125,
     -21510.122299239425,
     -21510.062283745945,
     -21510.001160244763,
     -21509.938769009303,
     -21509.874969183555,
     -21509.809637908827]
    plt.plot(log_probs)
    plt.annotate('poor convergence', xy=(50, -22200),  xycoords='data',
                    xytext=(0.5, 0.5),  textcoords='axes fraction',
                    arrowprops=dict(facecolor='black', shrink=0.1),
                    horizontalalignment='left', verticalalignment='top',
                    )
    plt.xlabel("Iteration")
    plt.ylabel("$\log P(O|\,\lambda)$")
    plt.savefig("logProbs.pdf")
    plt.clf()
    
if __name__ == "__main__":
    logProbs()
